
<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript">

function main()
{
  $(document).ready(function(){

  var canvas = document.querySelector('canvas');
  var c= canvas.getContext('2d');
  c.beginPath();
  var circle={
    x:10,
    y:10,
    r:5,
    vx:2,
    vy:2
    
  }
  var globalID;
// c.arc(circle.x, circle.y, circle.r, 0 ,2*Math.PI);
// c.stroke();

var canvas_w =canvas.width;
var canvas_h = canvas.height;

c.fillStyle = "#ffffff";
c.fillRect(0, 0, canvas.width, canvas.height);
recta={
  x:100,
  y:100,
  width:200,
  height:100
}
  // circle.vx = document.getElementById("speed_limit").value;
  // circle.x = document.getElementById("user_x").value;
  // circle.y = document.getElementById("user_y").value;
  // circle.vy = circle.vx;
  // console.log(circle.x);
  // console.log(circle.y);
var diff_x,diff_y;
var flag=0;

function draw()
{
  c.fillStyle = "#ffffff";
  c.fillRect(0, 0, canvas.width, canvas.height); 

  c.fillStyle = "red";
  c.fillRect(recta.x,recta.y,recta.width,recta.height);
  

// for(var i=0; i <= 2 ; i++)
//     {
          c.fillStyle = "black";
          c.beginPath();
          c.arc(circle.x, circle.y, circle.r, 0, Math.PI * 2, true);
          c.fill();

          if(((circle.x +circle.r )<= recta.x)&&((circle.y +circle.r) <= recta.y))
          {
            if((circle.y + circle.r )== (recta.y)&& ((circle.x +circle.r )==(recta.x)))
            {
               //  circle.vy =   Math.floor((Math.random() * 3) + 1);
               // circle.vx =   Math.floor((Math.random() * 3) + 1);
                circle.vy =   - Math.floor((Math.random() * 1) + 4);
                circle.vx =   - Math.floor((Math.random() * 1) + 3);
            }
            else
            {
              next_x = (circle.x + circle.r)+ circle.vx ;
              next_y = (circle.y + circle.r)+ circle.vy ;
              if(((next_x) >= recta.x ) && ((next_y)>=recta.y) && ((next_x)<= (recta.x+recta.width)) && ((next_y)<=(recta.y + recta.height)))
              {
                  circle.y = circle.y + (recta.y - (circle.y+circle.r));
                  circle.x = circle.x + (recta.x - (circle.x+circle.r));
                  flag=1;
              }
            }

          }
          else if(((circle.y+circle.r)<= recta.y)&&((circle.x - circle.r)>= (recta.x + recta.width)))
          {
              if((circle.y  +circle.r)== (recta.y)&& ((circle.x - circle.r )==(recta.x + recta.width)))
              {
               //   circle.vy =   Math.floor((Math.random() * 3) + 1);
               // circle.vx =   Math.floor((Math.random() * 3) + 1);

                circle.vy =   - Math.floor((Math.random() * 1) + 4);
                circle.vx =    Math.floor((Math.random() * 1) + 3);
              }
              else
              {
                  next_x = (circle.x - circle.r)+ circle.vx ;
                  next_y = (circle.y + circle.r)+ circle.vy ;

                  if(((next_x) >= recta.x ) && ((next_y)>=recta.y) && ((next_x)<= (recta.x+recta.width)) && ((next_y)<=(recta.y + recta.height)))
                  {
                      circle.y = circle.y + (recta.y - (circle.y+circle.r));
                      circle.x = circle.x - ((circle.x - circle.r) - (recta.x + recta.width));
                      flag=1;
                  }
              }
          }
          
          else if(((circle.x + circle.r )>=(recta.x +recta.width))&&((circle.y + circle.r)>=(recta.y +recta.height)))
          {
              if((circle.y + circle.r )== (recta.y + recta.height)&& ((circle.x - circle.r )==(recta.x +recta.width)))
              {
               // circle.vy =   Math.floor((Math.random() * 3) + 1);
               // circle.vx =   Math.floor((Math.random() * 3) + 1);
                circle.vy =   - Math.floor((Math.random() * 1) + 4);
                circle.vx =   - Math.floor((Math.random() * 1) + 3);
              }
              else
              {
                  next_x = (circle.x - circle.r)+ circle.vx ;
                  next_y = (circle.y - circle.r)+ circle.vy ;

                  if(((next_x) >= recta.x ) && ((next_y)>=recta.y) && ((next_x)<= (recta.x+recta.width)) && ((next_y)<=(recta.y + recta.height)))
                  {
                      circle.y = circle.y - ((circle.y - circle.r) - (recta.y + recta.height));
                      circle.x = circle.x - ((circle.x - circle.r) - (recta.x + recta.width));
                      flag=1;
                  }
              }
          }
          else if((circle.y - circle.r)>=(recta.y + recta.height)&& ((circle.x +circle.r)<=(recta.x)))
          {
             if((circle.y - circle.r)== (recta.y + recta.height)&& ((circle.x +circle.r)==(recta.x)))
              {
               //  circle.vy =   Math.floor((Math.random() * 3) + 1);
               // circle.vx =   Math.floor((Math.random() * 3) + 1);
                circle.vy =   Math.floor((Math.random() * 1) + 4);
                circle.vx =  - Math.floor((Math.random() * 1) + 3);
              }
              else
              {
                  next_x = (circle.x + circle.r)+ circle.vx ;
                  next_y = (circle.y - circle.r)+ circle.vy ;

                  if(((next_x) >= recta.x ) && ((next_y)>=recta.y) && ((next_x)<= (recta.x+recta.width)) && ((next_y)<=(recta.y + recta.height)))
                  {
                      circle.y = circle.y - ((circle.y - circle.r) - (recta.y + recta.height));
                      circle.x = circle.x + ((recta.x) - (circle.x + circle.r));
                      flag=1;
                  }
              }
              
          }
         
         
          else
          {
                if(((circle.x + circle.r)  >= recta.x )&&( (circle.x -circle.r) <= (recta.x + recta.width) ))
                {
                    if((circle.y + circle.r)  == recta.y)
                      {
                          circle.vy = -Math.abs(circle.vy);
                      }
                    else if((circle.y +circle.r ) < recta.y)
                    {
                      next_y  = (circle.y+circle.r) + circle.vy;
                      if(next_y >= recta.y)
                      {
                        diff_y = recta.y - (circle.y+circle.r);
                        circle.y = (circle.y + diff_y); 
                        flag=1;
                        
                        // cancelAnimationFrame(globalID);
                        // requestAnimationFrame(draw);
                        // return;
                       } 
                    }
                    if((circle.y -circle.r) == (recta.y + recta.height))
                    {
                      circle.vy = Math.abs(circle.vy);
                    }  
                    else if((circle.y -circle.r) > (recta.y + recta.height))
                    {

                      next_y  = (circle.y -circle.r) + circle.vy;
                      if(next_y <= (recta.y + recta.height))
                      {
                        diff_y = (recta.y + recta.height)-(circle.y-circle.r);
                        circle.y = (circle.y + diff_y); 
                        // cancelAnimationFrame(globalID);
                        // requestAnimationFrame(draw);
                        //return;
                       
                        flag=1;
                        
                       } 
                    }
                }

              if(((circle.y + circle.r) >= recta.y )&&((circle.y-circle.r) <= (recta.y + recta.height)))
              {
                if((circle.x + circle.r) == recta.x )
                  {
                     circle.vx = -Math.abs(circle.vx);
                  }
                else if((circle.x +circle.r) < recta.x )
                {
                  next_x = (circle.x+circle.r) + circle.vx;
                  if(next_x >= recta.x)
                  {
                      diff_x = recta.x-(circle.x+circle.r);
                      circle.x = (circle.x + diff_x); 
                        // cancelAnimationFrame(globalID);
                        // requestAnimationFrame(draw);
                     //   return;
                     flag=1;
                    
                  }
                }
                 if((circle.x-circle.r) ==(recta.x + recta.width ))
                 {
                   circle.vx = Math.abs(circle.vx);
                }
                else if((circle.x- circle.r) >= (recta.x +recta.width))
                {
                  next_x = (circle.x - circle.r) + circle.vx;
                  if(next_x <= (recta.x +recta.width))
                  {
                    diff_x = (recta.x + recta.width)-(circle.x -circle.r) ;
                    circle.x = (circle.x + diff_x);
                        // cancelAnimationFrame(globalID);
                        // requestAnimationFrame(draw);
                     //   return;
                     flag=1;
                     
                  }
                }
              }
          }



      /***CANVAS******/
          if ( (circle.x+circle.r)  >= canvas.width) {
            circle.vx = -Math.abs(circle.vx);
          }
          else if( (circle.x -circle.r)   <= 0 ){
                circle.vx = Math.abs(circle.vx);
          } 

          if ((circle.y+ circle.r)  >= 0 + canvas.height ) {
              circle.vy = -Math.abs(circle.vy);
          }
          else if( (circle.y - circle.r)  <= 0){
                circle.vy = Math.abs(circle.vy);
          }
          
            if(flag!=1)
            {
              circle.x = circle.x + circle.vx;
              circle.y = circle.y + circle.vy;

            }
     // }
  
  globalID = requestAnimationFrame(draw);
    flag=0;
}

globalID = requestAnimationFrame(draw);
});

}

</script>

<style type="text/css">
  canvas
  {
    
    border: 1px solid black;
  }

</style>
<body>
<canvas width="600" height="300"></canvas>
<!-- <div style="display: inline-block;">
  <label>Enter the speed of the ball u want:</label>
  <input type="textbox" id="speed_limit" value="7">
  <input type="textbox" id="user_x" value="10">
  <input type="textbox" id="user_y" value="10">
</div> -->
<button onclick="main()"> Apply</button>
</body>
</html>